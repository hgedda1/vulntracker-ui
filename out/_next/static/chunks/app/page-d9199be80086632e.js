(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4747:(e,t,s)=>{Promise.resolve().then(s.bind(s,93926))},93926:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eG});var a=s(58081),r=s(82149),l=s(76522),i=s(14483);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,i.QP)((0,l.$)(t))}let o=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:n("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});o.displayName="Input";var d=s(79907),c=s(23484);let m=(0,c.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),h=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:i=!1,...o}=e,c=i?d.DX:"button";return(0,a.jsx)(c,{className:n(m({variant:r,size:l,className:s})),ref:t,...o})});h.displayName="Button";var u=s(3699),x=s(60392),f=s(56801),g=s(76722);let p=u.bL;u.YJ;let b=u.WT,j=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(u.l9,{ref:t,className:n("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...l,children:[r,(0,a.jsx)(u.In,{asChild:!0,children:(0,a.jsx)(x.A,{className:"h-4 w-4 opacity-50"})})]})});j.displayName=u.l9.displayName;let v=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(u.PP,{ref:t,className:n("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})});v.displayName=u.PP.displayName;let w=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(u.wn,{ref:t,className:n("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(x.A,{className:"h-4 w-4"})})});w.displayName=u.wn.displayName;let N=r.forwardRef((e,t)=>{let{className:s,children:r,position:l="popper",...i}=e;return(0,a.jsx)(u.ZL,{children:(0,a.jsxs)(u.UC,{ref:t,className:n("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,a.jsx)(v,{}),(0,a.jsx)(u.LM,{className:n("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(w,{})]})})});N.displayName=u.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(u.JU,{ref:t,className:n("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=u.JU.displayName;let y=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(u.q7,{ref:t,className:n("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(u.VF,{children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})}),(0,a.jsx)(u.p4,{children:r})]})});y.displayName=u.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(u.wv,{ref:t,className:n("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=u.wv.displayName;let k=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:n("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});k.displayName="Card";let D=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:n("flex flex-col space-y-1.5 p-6",s),...r})});D.displayName="CardHeader";let C=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:n("text-2xl font-semibold leading-none tracking-tight",s),...r})});C.displayName="CardTitle";let A=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:n("text-sm text-muted-foreground",s),...r})});A.displayName="CardDescription";let S=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:n("p-6 pt-0",s),...r})});S.displayName="CardContent";let R=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:n("flex items-center p-6 pt-0",s),...r})});R.displayName="CardFooter";let T=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:n("w-full caption-bottom text-sm",s),...r})})});T.displayName="Table";let L=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:n("[&_tr]:border-b",s),...r})});L.displayName="TableHeader";let z=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:n("[&_tr:last-child]:border-0",s),...r})});z.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:n("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let W=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:n("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});W.displayName="TableRow";let M=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:n("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});M.displayName="TableHead";let U=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:n("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});U.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:n("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption";let _=(0,c.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function I(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:n(_({variant:s}),t),...r})}var P=s(59921),V=s(5516),K=s(64404);function O(e){let{vulnerabilities:t}=e,s=e=>{let t=e.shortDescription.toLowerCase(),s=e.vulnerabilityName.toLowerCase(),a="Known"===e.knownRansomwareCampaignUse,r=5;return t.includes("critical")||s.includes("critical")?r+=4:t.includes("high")||s.includes("high")?r+=3:(t.includes("medium")||s.includes("medium"))&&(r+=2),t.includes("remote code execution")&&(r+=3),t.includes("privilege escalation")&&(r+=2),a&&(r+=2),Math.floor((Date.now()-new Date(e.dateAdded).getTime())/864e5)>30&&(r+=1),Math.min(r,10)},r=e=>new Date(e)<new Date;return(0,a.jsx)("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:(0,a.jsxs)(T,{children:[(0,a.jsx)(L,{children:(0,a.jsxs)(W,{className:"bg-slate-50 hover:bg-slate-50",children:[(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"CVE ID"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Vendor/Product"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Vulnerability"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Severity"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Risk Score"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Date Added"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Due Date"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Ransomware"}),(0,a.jsx)(M,{className:"font-semibold text-slate-700",children:"Actions"})]})}),(0,a.jsx)(z,{children:t.map(e=>(0,a.jsxs)(W,{className:"hover:bg-slate-50 transition-colors ".concat(r(e.dueDate)?"bg-red-50 hover:bg-red-100":""),children:[(0,a.jsx)(U,{className:"font-mono font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-slate-900",children:e.cveID}),r(e.dueDate)&&(0,a.jsx)(P.A,{className:"h-4 w-4 text-red-500"})]})}),(0,a.jsx)(U,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-slate-900",children:e.vendorProject}),(0,a.jsx)("div",{className:"text-sm text-slate-500",children:e.product})]})}),(0,a.jsx)(U,{children:(0,a.jsxs)("div",{className:"max-w-xs",children:[(0,a.jsx)("div",{className:"font-medium truncate text-slate-900",children:e.vulnerabilityName}),(0,a.jsx)("div",{className:"text-sm text-slate-500 truncate",children:e.shortDescription})]})}),(0,a.jsxs)(U,{children:["critical"===e.severity&&(0,a.jsx)(I,{className:"bg-red-500 hover:bg-red-600 text-white",children:"Critical"}),"high"===e.severity&&(0,a.jsx)(I,{className:"bg-orange-500 hover:bg-orange-600 text-white",children:"High"}),"medium"===e.severity&&(0,a.jsx)(I,{className:"bg-yellow-500 hover:bg-yellow-600 text-white",children:"Medium"}),"low"===e.severity&&(0,a.jsx)(I,{className:"bg-green-500 hover:bg-green-600 text-white",children:"Low"})]}),(0,a.jsx)(U,{children:(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold ".concat(s(e)>=8?"bg-red-500":s(e)>=6?"bg-orange-500":s(e)>=4?"bg-yellow-500":"bg-green-500"),children:s(e)})})}),(0,a.jsx)(U,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-slate-600",children:[(0,a.jsx)(V.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.dateAdded})]})}),(0,a.jsx)(U,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-1 ".concat(r(e.dueDate)?"text-red-600":"text-slate-600"),children:[(0,a.jsx)(V.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.dueDate})]})}),(0,a.jsx)(U,{children:"Known"===e.knownRansomwareCampaignUse?(0,a.jsx)(I,{className:"bg-red-500 hover:bg-red-600 text-white",children:"Known"}):(0,a.jsx)(I,{variant:"secondary",className:"bg-slate-100 text-slate-700",children:"Unknown"})}),(0,a.jsx)(U,{children:(0,a.jsxs)(h,{variant:"outline",size:"sm",onClick:()=>window.open("https://cve.mitre.org/cgi-bin/cvename.cgi?name=".concat(e.cveID),"_blank"),className:"border-slate-200 hover:bg-slate-50",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-1"}),"View CVE"]})})]},e.cveID))})]})})}var E=s(56336),F=s(13577);function H(e){let{vulnerabilities:t}=e,s=e=>{let t=e.shortDescription.toLowerCase(),s=e.vulnerabilityName.toLowerCase(),a="Known"===e.knownRansomwareCampaignUse,r=5;return t.includes("critical")||s.includes("critical")?r+=4:t.includes("high")||s.includes("high")?r+=3:(t.includes("medium")||s.includes("medium"))&&(r+=2),t.includes("remote code execution")&&(r+=3),t.includes("privilege escalation")&&(r+=2),a&&(r+=2),Math.floor((Date.now()-new Date(e.dateAdded).getTime())/864e5)>30&&(r+=1),Math.min(r,10)},r=e=>new Date(e)<new Date;return(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t.map(e=>(0,a.jsxs)(k,{className:"flex flex-col h-full shadow-md hover:shadow-lg transition-shadow duration-200 ".concat(r(e.dueDate)?"border-red-400 bg-red-50":"border-slate-200 bg-white"),children:[(0,a.jsxs)(D,{className:"pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)(C,{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.cveID,r(e.dueDate)&&(0,a.jsx)(P.A,{className:"h-4 w-4 text-red-500"})]}),"critical"===e.severity&&(0,a.jsx)(I,{className:"bg-red-500 text-white",children:"Critical"}),"high"===e.severity&&(0,a.jsx)(I,{className:"bg-orange-500 text-white",children:"High"}),"medium"===e.severity&&(0,a.jsx)(I,{className:"bg-yellow-500 text-white",children:"Medium"}),"low"===e.severity&&(0,a.jsx)(I,{className:"bg-green-500 text-white",children:"Low"})]}),(0,a.jsxs)(A,{className:"text-sm text-slate-600",children:[(0,a.jsx)("span",{className:"font-medium",children:e.vendorProject})," / ",e.product]})]}),(0,a.jsxs)(S,{className:"flex-grow space-y-2 text-sm text-slate-700",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.vulnerabilityName}),(0,a.jsx)("p",{className:"line-clamp-3",children:e.shortDescription}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 text-slate-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Risk Score:"}),(0,a.jsxs)(I,{className:"text-white font-bold ".concat(s(e)>=8?"bg-red-500":s(e)>=6?"bg-orange-500":s(e)>=4?"bg-yellow-500":"bg-green-500"),children:[s(e),"/10"]})]}),"Known"===e.knownRansomwareCampaignUse&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:"Known Ransomware Use"})]})]}),(0,a.jsxs)(R,{className:"flex justify-between items-center pt-4 border-t border-slate-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-slate-500",children:[(0,a.jsx)(V.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:["Due: ",e.dueDate]})]}),(0,a.jsxs)(h,{variant:"outline",size:"sm",onClick:()=>window.open("https://cve.mitre.org/cgi-bin/cvename.cgi?name=".concat(e.cveID),"_blank"),className:"text-xs px-2 py-1 h-auto border-slate-200 hover:bg-slate-50",children:[(0,a.jsx)(K.A,{className:"h-3 w-3 mr-1"}),"View CVE"]})]})]},e.cveID))})}var q=s(26494),J=s(63602),B=s(48022);let Z=q.bL,G=q.l9;q.YJ,q.ZL,q.Pb,q.z6,r.forwardRef((e,t)=>{let{className:s,inset:r,children:l,...i}=e;return(0,a.jsxs)(q.ZP,{ref:t,className:n("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...i,children:[l,(0,a.jsx)(J.A,{className:"ml-auto"})]})}).displayName=q.ZP.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(q.G5,{ref:t,className:n("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}).displayName=q.G5.displayName;let Y=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...l}=e;return(0,a.jsx)(q.ZL,{children:(0,a.jsx)(q.UC,{ref:t,sideOffset:r,className:n("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})});Y.displayName=q.UC.displayName;let Q=r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(q.q7,{ref:t,className:n("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...l})});Q.displayName=q.q7.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:l,...i}=e;return(0,a.jsxs)(q.H_,{ref:t,className:n("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:l,...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(q.VF,{children:(0,a.jsx)(g.A,{className:"h-4 w-4"})})}),r]})}).displayName=q.H_.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(q.hN,{ref:t,className:n("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(q.VF,{children:(0,a.jsx)(B.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=q.hN.displayName,r.forwardRef((e,t)=>{let{className:s,inset:r,...l}=e;return(0,a.jsx)(q.JU,{ref:t,className:n("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...l})}).displayName=q.JU.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(q.wv,{ref:t,className:n("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=q.wv.displayName;var X=s(55058),$=s(93931),ee=s(60123),et=s(62544);function es(e){let{vulnerabilities:t}=e;return(0,a.jsxs)(Z,{children:[(0,a.jsx)(G,{asChild:!0,children:(0,a.jsxs)(h,{variant:"outline",children:[(0,a.jsx)(X.A,{className:"h-4 w-4 mr-2"}),"Export"]})}),(0,a.jsxs)(Y,{children:[(0,a.jsxs)(Q,{onClick:()=>{let e=new Blob([["CVE ID,Vendor Project,Product,Vulnerability Name,Date Added,Short Description,Required Action,Due Date,Known Ransomware Campaign Use,Notes",...t.map(e=>[e.cveID,'"'.concat(e.vendorProject,'"'),'"'.concat(e.product,'"'),'"'.concat(e.vulnerabilityName,'"'),e.dateAdded,'"'.concat(e.shortDescription,'"'),'"'.concat(e.requiredAction,'"'),e.dueDate,e.knownRansomwareCampaignUse,'"'.concat(e.notes,'"')].join(","))].join("\n")],{type:"text/csv"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="vulnerabilities-".concat(new Date().toISOString().split("T")[0],".csv"),a.click(),URL.revokeObjectURL(s)},children:[(0,a.jsx)($.A,{className:"h-4 w-4 mr-2"}),"Export as CSV"]}),(0,a.jsxs)(Q,{onClick:()=>{let e=new Blob([JSON.stringify({vulnerabilities:t},null,2)],{type:"application/json"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="vulnerabilities-".concat(new Date().toISOString().split("T")[0],".json"),a.click(),URL.revokeObjectURL(s)},children:[(0,a.jsx)(ee.A,{className:"h-4 w-4 mr-2"}),"Export as JSON"]}),(0,a.jsxs)(Q,{onClick:()=>{let e="# Vulnerability Report\n\n";e+="Generated on: ".concat(new Date().toLocaleDateString(),"\n\n"),e+="Total Vulnerabilities: ".concat(t.length,"\n\n"),t.forEach(t=>{e+="## ".concat(t.cveID,"\n\n"),e+="**Vendor/Product:** ".concat(t.vendorProject," - ").concat(t.product,"\n\n"),e+="**Vulnerability:** ".concat(t.vulnerabilityName,"\n\n"),e+="**Description:** ".concat(t.shortDescription,"\n\n"),e+="**Date Added:** ".concat(t.dateAdded,"\n\n"),e+="**Due Date:** ".concat(t.dueDate,"\n\n"),e+="**Required Action:** ".concat(t.requiredAction,"\n\n"),e+="**Ransomware Campaign:** ".concat(t.knownRansomwareCampaignUse,"\n\n"),t.notes&&(e+="**Notes:** ".concat(t.notes,"\n\n")),e+="---\n\n"});let s=new Blob([e],{type:"text/markdown"}),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download="vulnerabilities-".concat(new Date().toISOString().split("T")[0],".md"),r.click(),URL.revokeObjectURL(a)},children:[(0,a.jsx)(et.A,{className:"h-4 w-4 mr-2"}),"Export as Markdown"]})]})]})}var ea=s(31511),er=s(2151);function el(e){let{vulnerabilities:t}=e,s=t.length,r=t.filter(e=>new Date(e.dueDate)<new Date).length,l=t.filter(e=>"Known"===e.knownRansomwareCampaignUse).length,i=t.filter(e=>{let t=e.shortDescription.toLowerCase(),s=e.vulnerabilityName.toLowerCase();return t.includes("critical")||s.includes("critical")||t.includes("remote code execution")}).length,n=t.filter(e=>{let t=new Date(e.dueDate),s=new Date,a=Math.ceil((t.getTime()-s.getTime())/864e5);return a<=7&&a>=0}).length,o=t.filter(e=>{let t=new Date(e.dateAdded);return 7>=Math.ceil((new Date().getTime()-t.getTime())/864e5)}).length,d=[{title:"Total CVEs",value:s,description:"Known exploited vulnerabilities",icon:ea.A,color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-600"},{title:"Critical",value:i,description:"Critical severity vulnerabilities",icon:P.A,color:"bg-red-500",bgColor:"bg-red-50",textColor:"text-red-600"},{title:"Overdue",value:r,description:"Past due date",icon:V.A,color:"bg-red-500",bgColor:"bg-red-50",textColor:"text-red-600"},{title:"Due Soon",value:n,description:"Due within 7 days",icon:V.A,color:"bg-orange-500",bgColor:"bg-orange-50",textColor:"text-orange-600"},{title:"Ransomware",value:l,description:"Known ransomware campaigns",icon:F.A,color:"bg-purple-500",bgColor:"bg-purple-50",textColor:"text-purple-600"},{title:"Recently Added",value:o,description:"Added in last 7 days",icon:er.A,color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-600"}];return(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:d.map((e,t)=>{let s=e.icon;return(0,a.jsxs)(k,{className:"".concat(e.bgColor," border-0 shadow-sm hover:shadow-md transition-shadow duration-200"),children:[(0,a.jsxs)(D,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(C,{className:"text-sm font-medium text-slate-700",children:e.title}),(0,a.jsx)("div",{className:"p-2 rounded-full ".concat(e.color),children:(0,a.jsx)(s,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(S,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold ".concat(e.textColor),children:e.value}),(0,a.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:e.description})]})]},t)})})}var ei=s(97570);let en=ei.bL,eo=ei.l9,ed=r.forwardRef((e,t)=>{let{className:s,align:r="center",sideOffset:l=4,...i}=e;return(0,a.jsx)(ei.ZL,{children:(0,a.jsx)(ei.UC,{ref:t,align:r,sideOffset:l,className:n("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});ed.displayName=ei.UC.displayName;var ec=s(12923),em=s(78266),eh=s(25791);let eu={light:"",dark:".dark"},ex=r.createContext(null);function ef(){let e=r.useContext(ex);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}r.forwardRef((e,t)=>{let{id:s,className:l,children:i,config:o,...d}=e,c=r.useId(),m="chart-".concat(s||c.replace(/:/g,""));return(0,a.jsx)(ex.Provider,{value:{config:o},children:(0,a.jsxs)("div",{"data-chart":m,ref:t,className:n("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",l),...d,children:[(0,a.jsx)(eg,{id:m,config:o}),(0,a.jsx)(ec.u,{children:i})]})})}).displayName="Chart";let eg=e=>{let{id:t,config:s}=e,r=Object.entries(s).filter(e=>{let[t,s]=e;return s.theme||s.color});return r.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(eu).map(e=>{let[s,a]=e;return"\n".concat(a," [data-chart=").concat(t,"] {\n").concat(r.map(e=>{var t;let[a,r]=e,l=(null===(t=r.theme)||void 0===t?void 0:t[s])||r.color;return l?"  --color-".concat(a,": ").concat(l,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},ep=em.m;function eb(e,t,s){if("object"!=typeof t||null===t)return;let a="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,r=s;return s in t&&"string"==typeof t[s]?r=t[s]:a&&s in a&&"string"==typeof a[s]&&(r=a[s]),r in e?e[r]:e[s]}r.forwardRef((e,t)=>{let{active:s,payload:l,className:i,indicator:o="dot",hideLabel:d=!1,hideIndicator:c=!1,label:m,labelFormatter:h,labelClassName:u,formatter:x,color:f,nameKey:g,labelKey:p}=e,{config:b}=ef(),j=r.useMemo(()=>{var e;if(d||!(null==l?void 0:l.length))return null;let[t]=l,s="".concat(p||t.dataKey||t.name||"value"),r=eb(b,t,s),i=p||"string"!=typeof m?null==r?void 0:r.label:(null===(e=b[m])||void 0===e?void 0:e.label)||m;return h?(0,a.jsx)("div",{className:n("font-medium",u),children:h(i,l)}):i?(0,a.jsx)("div",{className:n("font-medium",u),children:i}):null},[m,h,l,d,u,b,p]);if(!s||!(null==l?void 0:l.length))return null;let v=1===l.length&&"dot"!==o;return(0,a.jsxs)("div",{ref:t,className:n("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",i),children:[v?null:j,(0,a.jsx)("div",{className:"grid gap-1.5",children:l.map((e,t)=>{let s="".concat(g||e.name||e.dataKey||"value"),r=eb(b,e,s),l=f||e.payload.fill||e.color;return(0,a.jsx)("div",{className:n("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===o&&"items-center"),children:x&&(null==e?void 0:e.value)!==void 0&&e.name?x(e.value,e.name,e,t,e.payload):(0,a.jsxs)(a.Fragment,{children:[(null==r?void 0:r.icon)?(0,a.jsx)(r.icon,{}):!c&&(0,a.jsx)("div",{className:n("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===o,"w-1":"line"===o,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===o,"my-0.5":v&&"dashed"===o}),style:{"--color-bg":l,"--color-border":l}}),(0,a.jsxs)("div",{className:n("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,a.jsxs)("div",{className:"grid gap-1.5",children:[v?j:null,(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,a.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})}).displayName="ChartTooltip",eh.s,r.forwardRef((e,t)=>{let{className:s,hideIcon:r=!1,payload:l,verticalAlign:i="bottom",nameKey:o}=e,{config:d}=ef();return(null==l?void 0:l.length)?(0,a.jsx)("div",{ref:t,className:n("flex items-center justify-center gap-4","top"===i?"pb-3":"pt-3",s),children:l.map(e=>{let t="".concat(o||e.dataKey||"value"),s=eb(d,e,t);return(0,a.jsxs)("div",{className:n("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==s?void 0:s.icon)&&!r?(0,a.jsx)(s.icon,{}):(0,a.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==s?void 0:s.label]},e.value)})}):null}).displayName="ChartLegend";var ej=s(74986),ev=s(76183),ew=s(27862),eN=s(91718),ey=s(28605),ek=s(63042),eD=s(26093),eC=s(99212),eA=s(23772),eS=s(40096),eR=s(15032),eT=s(8255),eL=s(66535),ez=s(81794),eW=s(60118),eM=s(9754);let eU={critical:"#dc2626",high:"#ea580c",medium:"#d97706",low:"#059669"},e_={secondary:"#64748b",accent:"#3b82f6",success:"#10b981",warning:"#f59e0b",danger:"#ef4444"},eI={severity:{title:"Severity Distribution",description:"Shows the breakdown of vulnerabilities by severity level. Critical and High severity vulnerabilities require immediate attention.",insights:["Critical: Remote code execution, system compromise","High: Privilege escalation, authentication bypass","Medium: Information disclosure, DoS attacks","Low: Minor security issues with limited impact"]},dueDate:{title:"Due Date Status",description:"Tracks vulnerability remediation deadlines to ensure SLA compliance and prioritize urgent fixes.",insights:["Overdue: Past remediation deadline - immediate action required","Due Soon: Within 7 days - high priority","This Month: Within 30 days - medium priority","Future: Beyond 30 days - plan accordingly"]},ransomware:{title:"Ransomware Campaign Usage",description:"Identifies vulnerabilities actively exploited by ransomware groups, indicating higher risk and urgency.",insights:["Known: Confirmed ransomware exploitation - critical priority","Unknown: No known ransomware usage - standard priority","Monitor threat intelligence for status changes"]},trend:{title:"Monthly Vulnerability Trend",description:"Displays the volume of new vulnerabilities added over time to identify patterns and workload trends.",insights:["Track monthly vulnerability discovery rates","Identify seasonal patterns or spikes","Plan resource allocation based on trends","Monitor overall security posture improvement"]},vendors:{title:"Top Affected Vendors",description:"Shows which vendors have the most vulnerabilities, helping prioritize vendor risk management and patching efforts.",insights:["Focus patching efforts on high-count vendors","Assess vendor security practices","Consider alternative solutions for problematic vendors","Negotiate better security SLAs with top vendors"]},severityTrend:{title:"Severity Trend Over Time",description:"Tracks how the severity distribution of vulnerabilities changes over time to assess threat landscape evolution.",insights:["Monitor if critical vulnerabilities are increasing","Assess effectiveness of security measures","Identify concerning trends in threat severity","Plan security strategy based on severity patterns"]}},eP=e=>{let{info:t}=e;return(0,a.jsxs)(en,{children:[(0,a.jsx)(eo,{asChild:!0,children:(0,a.jsx)(h,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-white/80 transition-colors",children:(0,a.jsx)(ez.A,{className:"h-4 w-4 text-slate-600 hover:text-slate-800"})})}),(0,a.jsx)(ed,{className:"w-80 p-0",side:"left",children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(eW.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("h4",{className:"font-semibold text-slate-900",children:t.title})]}),(0,a.jsx)("p",{className:"text-sm text-slate-700 mb-3 leading-relaxed",children:t.description}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-slate-600 uppercase tracking-wide",children:"Key Insights:"}),t.insights.map((e,t)=>(0,a.jsxs)("p",{className:"text-xs text-slate-600 leading-relaxed",children:["• ",e]},t))]})]})})]})},eV=e=>{let{cx:t,cy:s,midAngle:r,innerRadius:l,outerRadius:i,percent:n,name:o}=e,d=Math.PI/180,c=l+(i-l)*.5,m=t+c*Math.cos(-r*d),h=s+c*Math.sin(-r*d);return n<.05?null:(0,a.jsx)("text",{x:m,y:h,fill:"white",textAnchor:m>t?"start":"end",dominantBaseline:"central",fontSize:"13",fontWeight:"600",fontFamily:"Inter, system-ui, sans-serif",children:"".concat((100*n).toFixed(0),"%")})},eK=e=>{let{active:t,payload:s,label:r}=e;return t&&s&&s.length?(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-xl shadow-xl backdrop-blur-sm",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900 text-sm",children:"".concat(r)}),(0,a.jsx)("p",{className:"text-emerald-600 font-medium text-sm",children:"".concat(s[0].value," vulnerabilities")})]}):null};function eO(e){let{vulnerabilities:t,getSeverityLevel:s}=e,l=(0,r.useMemo)(()=>{let e=Object.entries(t.reduce((e,t)=>{let a=s(t);return e[a]=(e[a]||0)+1,e},{})).map(e=>{let[t,s]=e;return{name:t.charAt(0).toUpperCase()+t.slice(1),value:s,fill:eU[t]}}),a=Object.values(t.reduce((e,t)=>{let a=new Date(t.dateAdded),r="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"));e[r]||(e[r]={month:r,count:0,critical:0,high:0,medium:0,low:0}),e[r].count++;let l=s(t);return e[r][l]++,e},{})).sort((e,t)=>e.month.localeCompare(t.month)).slice(-12).map(e=>({...e,month:new Date(e.month+"-01").toLocaleDateString("en-US",{month:"short",year:"2-digit"})})),r=Object.entries(t.reduce((e,t)=>{let s=t.vendorProject.length>18?t.vendorProject.substring(0,18)+"...":t.vendorProject;return e[s]=(e[s]||0)+1,e},{})).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s}).slice(0,10).map(e=>{let[t,s]=e;return{vendor:t,count:s}}),l=Object.entries(t.reduce((e,t)=>{let s="Known"===t.knownRansomwareCampaignUse?"Known":"Unknown";return e[s]=(e[s]||0)+1,e},{})).map(e=>{let[t,s]=e;return{name:t,value:s,fill:"Known"===t?e_.danger:e_.secondary}}),i=new Date,n=t.reduce((e,t)=>{let s=Math.ceil((new Date(t.dueDate).getTime()-i.getTime())/864e5);return s<0?e.overdue++:s<=7?e.dueSoon++:s<=30?e.dueThisMonth++:e.future++,e},{overdue:0,dueSoon:0,dueThisMonth:0,future:0});return{severityData:e,trendData:a,vendorData:r,ransomwareData:l,dueDateData:[{name:"Overdue",value:n.overdue,fill:e_.danger},{name:"Due Soon",value:n.dueSoon,fill:e_.warning},{name:"This Month",value:n.dueThisMonth,fill:e_.accent},{name:"Future",value:n.future,fill:e_.success}]}},[t,s]);return(0,a.jsxs)("div",{className:"space-y-8 font-['Inter',system-ui,sans-serif]",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)(k,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-red-50/30 hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-red-500/10 to-orange-500/10 rounded-t-xl pb-4 border-b border-red-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(C,{className:"flex items-center space-x-3 text-slate-800 text-xl font-bold",children:[(0,a.jsx)("div",{className:"p-2 bg-red-500 rounded-lg shadow-sm",children:(0,a.jsx)(P.A,{className:"h-5 w-5 text-white"})}),(0,a.jsx)("span",{children:"Severity Distribution"})]}),(0,a.jsx)(eP,{info:eI.severity})]})}),(0,a.jsx)(S,{className:"p-6",children:(0,a.jsx)("div",{className:"h-[320px]",children:(0,a.jsx)(ec.u,{width:"100%",height:"100%",children:(0,a.jsxs)(ej.r,{children:[(0,a.jsx)(ev.F,{data:l.severityData,cx:"50%",cy:"50%",labelLine:!1,label:eV,outerRadius:100,innerRadius:40,fill:"#8884d8",dataKey:"value",strokeWidth:2,stroke:"#ffffff",children:l.severityData.map((e,t)=>(0,a.jsx)(ew.f,{fill:e.fill},"cell-".concat(t)))}),(0,a.jsx)(ep,{content:e=>{let{active:s,payload:r}=e;if(s&&r&&r.length){let e=r[0].payload;return(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-xl shadow-xl backdrop-blur-sm",children:[(0,a.jsx)("p",{className:"font-bold text-gray-900 text-base",children:"".concat(e.name,": ").concat(e.value)}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"".concat((e.value/t.length*100).toFixed(1),"% of total")})]})}return null}}),(0,a.jsx)(eh.s,{verticalAlign:"bottom",height:50,wrapperStyle:{paddingTop:"20px",fontSize:"14px",fontWeight:"600"},formatter:(e,t)=>(0,a.jsx)("span",{style:{color:t.color,fontWeight:600,fontSize:"14px"},children:e})})]})})})})]}),(0,a.jsxs)(k,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-amber-50/30 hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-amber-500/10 to-yellow-500/10 rounded-t-xl pb-4 border-b border-amber-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(C,{className:"flex items-center space-x-3 text-slate-800 text-xl font-bold",children:[(0,a.jsx)("div",{className:"p-2 bg-amber-500 rounded-lg shadow-sm",children:(0,a.jsx)(V.A,{className:"h-5 w-5 text-white"})}),(0,a.jsx)("span",{children:"Due Date Status"})]}),(0,a.jsx)(eP,{info:eI.dueDate})]})}),(0,a.jsx)(S,{className:"p-6",children:(0,a.jsx)("div",{className:"h-[320px]",children:(0,a.jsx)(ec.u,{width:"100%",height:"100%",children:(0,a.jsxs)(ej.r,{children:[(0,a.jsx)(ev.F,{data:l.dueDateData,cx:"50%",cy:"50%",labelLine:!1,label:eV,outerRadius:100,innerRadius:40,fill:"#8884d8",dataKey:"value",strokeWidth:2,stroke:"#ffffff",children:l.dueDateData.map((e,t)=>(0,a.jsx)(ew.f,{fill:e.fill},"cell-".concat(t)))}),(0,a.jsx)(ep,{content:e=>{let{active:s,payload:r}=e;if(s&&r&&r.length){let e=r[0].payload;return(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-xl shadow-xl backdrop-blur-sm",children:[(0,a.jsx)("p",{className:"font-bold text-gray-900 text-base",children:"".concat(e.name,": ").concat(e.value)}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"".concat((e.value/t.length*100).toFixed(1),"% of total")})]})}return null}}),(0,a.jsx)(eh.s,{verticalAlign:"bottom",height:50,wrapperStyle:{paddingTop:"20px",fontSize:"14px",fontWeight:"600"},formatter:(e,t)=>(0,a.jsx)("span",{style:{color:t.color,fontWeight:600,fontSize:"14px"},children:e})})]})})})})]}),(0,a.jsxs)(k,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-purple-50/30 hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-purple-500/10 to-violet-500/10 rounded-t-xl pb-4 border-b border-purple-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(C,{className:"flex items-center space-x-3 text-slate-800 text-xl font-bold",children:[(0,a.jsx)("div",{className:"p-2 bg-purple-500 rounded-lg shadow-sm",children:(0,a.jsx)(F.A,{className:"h-5 w-5 text-white"})}),(0,a.jsx)("span",{children:"Ransomware Usage"})]}),(0,a.jsx)(eP,{info:eI.ransomware})]})}),(0,a.jsx)(S,{className:"p-6",children:(0,a.jsx)("div",{className:"h-[320px]",children:(0,a.jsx)(ec.u,{width:"100%",height:"100%",children:(0,a.jsxs)(ej.r,{children:[(0,a.jsx)(ev.F,{data:l.ransomwareData,cx:"50%",cy:"50%",labelLine:!1,label:eV,outerRadius:100,innerRadius:40,fill:"#8884d8",dataKey:"value",strokeWidth:2,stroke:"#ffffff",children:l.ransomwareData.map((e,t)=>(0,a.jsx)(ew.f,{fill:e.fill},"cell-".concat(t)))}),(0,a.jsx)(ep,{content:e=>{let{active:s,payload:r}=e;if(s&&r&&r.length){let e=r[0].payload;return(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-xl shadow-xl backdrop-blur-sm",children:[(0,a.jsx)("p",{className:"font-bold text-gray-900 text-base",children:"".concat(e.name,": ").concat(e.value)}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"".concat((e.value/t.length*100).toFixed(1),"% of total")})]})}return null}}),(0,a.jsx)(eh.s,{verticalAlign:"bottom",height:50,wrapperStyle:{paddingTop:"20px",fontSize:"14px",fontWeight:"600"},formatter:(e,t)=>(0,a.jsx)("span",{style:{color:t.color,fontWeight:600,fontSize:"14px"},children:e})})]})})})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(k,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-blue-50/30 hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-blue-500/10 to-indigo-500/10 rounded-t-xl pb-4 border-b border-blue-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(C,{className:"flex items-center space-x-3 text-slate-800 text-xl font-bold",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-500 rounded-lg shadow-sm",children:(0,a.jsx)(er.A,{className:"h-5 w-5 text-white"})}),(0,a.jsx)("span",{children:"Monthly Trend"})]}),(0,a.jsx)(eP,{info:eI.trend})]})}),(0,a.jsx)(S,{className:"p-6",children:(0,a.jsx)("div",{className:"h-[340px]",children:(0,a.jsx)(ec.u,{width:"100%",height:"100%",children:(0,a.jsxs)(eN.Q,{data:l.trendData,children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorTrend",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:e_.accent,stopOpacity:.3}),(0,a.jsx)("stop",{offset:"95%",stopColor:e_.accent,stopOpacity:.05})]})}),(0,a.jsx)(ey.d,{strokeDasharray:"3 3",stroke:"#e2e8f0",strokeWidth:1}),(0,a.jsx)(ek.W,{dataKey:"month",stroke:"#64748b",fontSize:13,fontWeight:500,tick:{fill:"#64748b"}}),(0,a.jsx)(eD.h,{stroke:"#64748b",fontSize:13,fontWeight:500,tick:{fill:"#64748b"}}),(0,a.jsx)(ep,{content:e=>{let{active:t,payload:s,label:r}=e;return t&&s&&s.length?(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-xl shadow-xl backdrop-blur-sm",children:[(0,a.jsx)("p",{className:"font-bold text-gray-900 text-base mb-1",children:"Month: ".concat(r)}),(0,a.jsx)("p",{className:"text-blue-600 font-semibold text-base",children:"Vulnerabilities: ".concat(s[0].value)})]}):null}}),(0,a.jsx)(eC.G,{type:"monotone",dataKey:"count",stroke:e_.accent,fillOpacity:1,fill:"url(#colorTrend)",strokeWidth:3,dot:{fill:e_.accent,strokeWidth:2,r:5},activeDot:{r:7,stroke:e_.accent,strokeWidth:2,fill:"#ffffff"}})]})})})})]}),(0,a.jsxs)(k,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-emerald-50/30 hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-emerald-500/10 to-green-500/10 rounded-t-xl pb-4 border-b border-emerald-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(C,{className:"flex items-center space-x-3 text-slate-800 text-xl font-bold",children:[(0,a.jsx)("div",{className:"p-2 bg-emerald-500 rounded-lg shadow-sm",children:(0,a.jsx)(ea.A,{className:"h-5 w-5 text-white"})}),(0,a.jsx)("span",{children:"Top Affected Vendors"})]}),(0,a.jsx)(eP,{info:eI.vendors})]})}),(0,a.jsx)(S,{className:"p-6",children:(0,a.jsx)("div",{className:"h-[340px]",children:(0,a.jsx)(ec.u,{width:"100%",height:"100%",children:(0,a.jsxs)(eA.E,{data:l.vendorData,layout:"horizontal",margin:{left:90,right:30,top:20,bottom:20},children:[(0,a.jsx)(ey.d,{strokeDasharray:"3 3",stroke:"#e2e8f0",strokeWidth:1}),(0,a.jsx)(ek.W,{type:"number",stroke:"#64748b",fontSize:13,fontWeight:500,tick:{fill:"#64748b"}}),(0,a.jsx)(eD.h,{type:"category",dataKey:"vendor",stroke:"#64748b",width:85,fontSize:11,fontWeight:500,tick:{fontSize:11,fill:"#64748b"}}),(0,a.jsx)(ep,{content:(0,a.jsx)(eK,{})}),(0,a.jsx)(eS.y,{dataKey:"count",fill:e_.success,radius:[0,6,6,0],stroke:"#ffffff",strokeWidth:1,children:(0,a.jsx)(eR.Z,{dataKey:"count",position:"right",fontSize:12,fontWeight:600,fill:"#64748b"})})]})})})})]})]}),(0,a.jsxs)(k,{className:"shadow-lg border-0 bg-gradient-to-br from-white to-slate-50/50 hover:shadow-xl transition-all duration-300",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-slate-500/10 to-gray-500/10 rounded-t-xl pb-4 border-b border-slate-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(C,{className:"flex items-center space-x-3 text-slate-800 text-xl font-bold",children:[(0,a.jsx)("div",{className:"p-2 bg-slate-600 rounded-lg shadow-sm",children:(0,a.jsx)(eM.A,{className:"h-5 w-5 text-white"})}),(0,a.jsx)("span",{children:"Severity Trend Over Time"})]}),(0,a.jsx)(eP,{info:eI.severityTrend})]})}),(0,a.jsx)(S,{className:"p-6",children:(0,a.jsx)("div",{className:"h-[400px]",children:(0,a.jsx)(ec.u,{width:"100%",height:"100%",children:(0,a.jsxs)(eT.b,{data:l.trendData,children:[(0,a.jsx)(ey.d,{strokeDasharray:"3 3",stroke:"#e2e8f0",strokeWidth:1}),(0,a.jsx)(ek.W,{dataKey:"month",stroke:"#64748b",fontSize:13,fontWeight:500,tick:{fill:"#64748b"}}),(0,a.jsx)(eD.h,{stroke:"#64748b",fontSize:13,fontWeight:500,tick:{fill:"#64748b"}}),(0,a.jsx)(ep,{content:e=>{let{active:t,payload:s,label:r}=e;return t&&s&&s.length?(0,a.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-xl shadow-xl backdrop-blur-sm",children:[(0,a.jsx)("p",{className:"font-bold text-gray-900 text-base mb-3",children:"Month: ".concat(r)}),s.map((e,t)=>(0,a.jsx)("p",{style:{color:e.color},className:"font-semibold text-sm",children:"".concat(e.name,": ").concat(e.value)},t))]}):null}}),(0,a.jsx)(eh.s,{wrapperStyle:{paddingTop:"20px",fontSize:"14px",fontWeight:"600"}}),(0,a.jsx)(eL.N,{type:"monotone",dataKey:"critical",stroke:eU.critical,strokeWidth:4,dot:{r:6,fill:eU.critical,strokeWidth:2,stroke:"#ffffff"},activeDot:{r:8,stroke:eU.critical,strokeWidth:3,fill:"#ffffff"},name:"Critical"}),(0,a.jsx)(eL.N,{type:"monotone",dataKey:"high",stroke:eU.high,strokeWidth:4,dot:{r:6,fill:eU.high,strokeWidth:2,stroke:"#ffffff"},activeDot:{r:8,stroke:eU.high,strokeWidth:3,fill:"#ffffff"},name:"High"}),(0,a.jsx)(eL.N,{type:"monotone",dataKey:"medium",stroke:eU.medium,strokeWidth:4,dot:{r:6,fill:eU.medium,strokeWidth:2,stroke:"#ffffff"},activeDot:{r:8,stroke:eU.medium,strokeWidth:3,fill:"#ffffff"},name:"Medium"}),(0,a.jsx)(eL.N,{type:"monotone",dataKey:"low",stroke:eU.low,strokeWidth:4,dot:{r:6,fill:eU.low,strokeWidth:2,stroke:"#ffffff"},activeDot:{r:8,stroke:eU.low,strokeWidth:3,fill:"#ffffff"},name:"Low"})]})})})})]})]})}var eE=s(35808),eF=s(92950),eH=s(83427),eq=s(45842),eJ=s(46147);function eB(e){let{vulnerabilities:t,source:s}=e,[l,i]=(0,r.useState)(""),[n,d]=(0,r.useState)("dateAdded"),[c,m]=(0,r.useState)("desc"),[u,x]=(0,r.useState)("all"),[f,g]=(0,r.useState)("charts"),[v,w]=(0,r.useState)(1),[A,R]=(0,r.useState)([]),T=e=>{var t,s;let a=(null===(t=e.shortDescription)||void 0===t?void 0:t.toLowerCase())||"",r=(null===(s=e.vulnerabilityName)||void 0===s?void 0:s.toLowerCase())||"";return a.includes("critical")||r.includes("critical")||a.includes("remote code execution")||a.includes("rce")?"critical":a.includes("high")||r.includes("high")||a.includes("privilege escalation")||a.includes("authentication bypass")?"high":a.includes("medium")||r.includes("medium")||a.includes("information disclosure")||a.includes("denial of service")?"medium":"low"},L=(0,r.useMemo)(()=>t.map(e=>({...e,severity:T(e)})),[t]);(0,r.useEffect)(()=>{let e=new Date;R(L.filter(t=>new Date(t.dueDate)<e))},[L]),(0,r.useEffect)(()=>{w(1)},[l,u,n,c]);let z=(0,r.useMemo)(()=>L.filter(e=>{let t="".concat(e.cveID," ").concat(e.vendorProject," ").concat(e.product," ").concat(e.vulnerabilityName," ").concat(e.shortDescription).toLowerCase().includes(l.toLowerCase()),s="all"===u||e.severity===u;return t&&s}).sort((e,t)=>{let s="",a="";switch(n){case"dateAdded":s=new Date(e.dateAdded).getTime(),a=new Date(t.dateAdded).getTime();break;case"dueDate":s=new Date(e.dueDate).getTime(),a=new Date(t.dueDate).getTime();break;case"cveID":s=e.cveID,a=t.cveID;break;case"vendor":s=e.vendorProject,a=t.vendorProject;break;default:s=e.dateAdded,a=t.dateAdded}return"string"==typeof s&&"string"==typeof a?"asc"===c?s.localeCompare(a):a.localeCompare(s):"asc"===c?s-a:a-s}),[L,l,n,c,u]),W=(0,r.useMemo)(()=>z.slice((v-1)*50,50*v),[z,v]),M=z.length;return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:(0,a.jsxs)("div",{className:"container mx-auto p-6 space-y-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Vulnerability Management Dashboard"}),(0,a.jsxs)("p",{className:"text-slate-600 mt-2 flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("api"===s?"bg-green-500":"bg-blue-500")}),"Data Source: ","api"===s?"CISA API (Live)":"Local JSON file"]})]}),(0,a.jsx)(es,{vulnerabilities:z})]})}),A.length>0&&(0,a.jsx)(k,{className:"border-red-200 bg-gradient-to-r from-red-50 to-red-100 shadow-sm",children:(0,a.jsx)(S,{className:"pt-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-red-100 rounded-full",children:(0,a.jsx)(P.A,{className:"h-5 w-5 text-red-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"text-red-800 font-semibold text-lg",children:["SLA Alert: ",A.length," CVE",A.length>1?"s":""," past due date"]}),(0,a.jsx)("p",{className:"text-red-600 text-sm mt-1",children:"Immediate attention required for overdue vulnerabilities"})]})]})})}),(0,a.jsx)(el,{vulnerabilities:t}),(0,a.jsxs)(k,{className:"shadow-sm border-0 bg-white",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-slate-50 to-slate-100 rounded-t-lg",children:(0,a.jsxs)(C,{className:"flex items-center space-x-2 text-slate-800",children:[(0,a.jsx)(eE.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Filters & Search"})]})}),(0,a.jsx)(S,{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eF.A,{className:"absolute left-3 top-3 h-4 w-4 text-slate-400"}),(0,a.jsx)(o,{placeholder:"Search vulnerabilities...",value:l,onChange:e=>i(e.target.value),className:"pl-10 border-slate-200 focus:border-slate-400 focus:ring-slate-400"})]}),(0,a.jsxs)(p,{value:n,onValueChange:d,children:[(0,a.jsx)(j,{className:"border-slate-200 focus:border-slate-400 focus:ring-slate-400",children:(0,a.jsx)(b,{placeholder:"Sort by"})}),(0,a.jsxs)(N,{children:[(0,a.jsx)(y,{value:"dateAdded",children:"Date Added"}),(0,a.jsx)(y,{value:"dueDate",children:"Due Date"}),(0,a.jsx)(y,{value:"cveID",children:"CVE ID"}),(0,a.jsx)(y,{value:"vendor",children:"Vendor"})]})]}),(0,a.jsxs)(p,{value:c,onValueChange:e=>m(e),children:[(0,a.jsx)(j,{className:"border-slate-200 focus:border-slate-400 focus:ring-slate-400",children:(0,a.jsx)(b,{placeholder:"Order"})}),(0,a.jsxs)(N,{children:[(0,a.jsx)(y,{value:"desc",children:"Descending"}),(0,a.jsx)(y,{value:"asc",children:"Ascending"})]})]}),(0,a.jsxs)(p,{value:u,onValueChange:x,children:[(0,a.jsx)(j,{className:"border-slate-200 focus:border-slate-400 focus:ring-slate-400",children:(0,a.jsx)(b,{placeholder:"Filter by severity"})}),(0,a.jsxs)(N,{children:[(0,a.jsx)(y,{value:"all",children:"All Severities"}),(0,a.jsx)(y,{value:"critical",children:"Critical"}),(0,a.jsx)(y,{value:"high",children:"High"}),(0,a.jsx)(y,{value:"medium",children:"Medium"}),(0,a.jsx)(y,{value:"low",children:"Low"})]})]})]})})]}),(0,a.jsxs)(k,{className:"shadow-sm border-0 bg-white",children:[(0,a.jsx)(D,{className:"bg-gradient-to-r from-slate-50 to-slate-100 rounded-t-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(C,{className:"text-slate-800",children:"charts"===f?"Vulnerability Analytics (".concat(M," total)"):"Vulnerabilities (".concat((v-1)*50+1,"-").concat(Math.min(50*v,M)," of ").concat(M,")")}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(h,{variant:"charts"===f?"default":"outline",size:"sm",onClick:()=>g("charts"),className:"charts"===f?"bg-slate-900 hover:bg-slate-800":"border-slate-200 hover:bg-slate-50",children:[(0,a.jsx)(eH.A,{className:"h-4 w-4 mr-2"}),"Charts"]}),(0,a.jsxs)(h,{variant:"table"===f?"default":"outline",size:"sm",onClick:()=>g("table"),className:"table"===f?"bg-slate-900 hover:bg-slate-800":"border-slate-200 hover:bg-slate-50",children:[(0,a.jsx)(eq.A,{className:"h-4 w-4 mr-2"}),"Table"]}),(0,a.jsxs)(h,{variant:"tiles"===f?"default":"outline",size:"sm",onClick:()=>g("tiles"),className:"tiles"===f?"bg-slate-900 hover:bg-slate-800":"border-slate-200 hover:bg-slate-50",children:[(0,a.jsx)(eJ.A,{className:"h-4 w-4 mr-2"}),"Tiles"]})]})]})}),(0,a.jsxs)(S,{className:"p-6",children:["charts"===f?(0,a.jsx)(eO,{vulnerabilities:z,getSeverityLevel:T}):"table"===f?(0,a.jsx)(O,{vulnerabilities:W}):(0,a.jsx)(H,{vulnerabilities:W}),"charts"!==f&&(0,a.jsxs)("div",{className:"mt-6 flex justify-between items-center pt-4 border-t border-slate-100",children:[(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["Page ",v," of ",Math.ceil(M/50)]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(h,{variant:"outline",size:"sm",disabled:1===v,onClick:()=>w(e=>e-1),className:"border-slate-200 hover:bg-slate-50",children:"Previous"}),(0,a.jsx)(h,{variant:"outline",size:"sm",disabled:v>=Math.ceil(M/50),onClick:()=>w(e=>e+1),className:"border-slate-200 hover:bg-slate-50",children:"Next"})]})]})]})]})]})})}function eZ(){return(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading vulnerability data..."})]})}function eG(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)(!0),[i,n]=(0,r.useState)(null),[o,d]=(0,r.useState)(null);return((0,r.useEffect)(()=>{(async function(){try{l(!0);let s=[];try{let t=await fetch("/api/cisa");if(t.ok){var e;let a=await t.json();(null===(e=a.vulnerabilities)||void 0===e?void 0:e.length)>0&&(s=a.vulnerabilities,d("api"))}}catch(e){console.warn("API fetch failed, trying local fallback...")}if(0===s.length){let e=await fetch("/data/data.json");if(e.ok){let t=await e.json();s=t.vulnerabilities||t||[],d("local")}}t(s)}catch(e){n("Failed to load vulnerability data"),console.error("Error fetching data:",e)}finally{l(!1)}})()},[]),s)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)(eZ,{})}):i?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-600 mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-gray-600",children:i})]})}):(0,a.jsx)(eB,{vulnerabilities:e,source:o})}}},e=>{var t=t=>e(e.s=t);e.O(0,[970,497,954,358],()=>t(4747)),_N_E=e.O()}]);